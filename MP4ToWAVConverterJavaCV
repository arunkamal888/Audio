import javazoom.jl.decoder.Bitstream;
import javazoom.jl.decoder.Decoder;
import javazoom.jl.decoder.Header;
import javazoom.jl.decoder.SampleBuffer;

import java.io.FileInputStream;
import java.io.IOException;

public class MP3SilenceDetection {

    private static final int SILENCE_THRESHOLD = 500;  // Amplitude threshold for silence
    private static final int SILENCE_DURATION = 1000;  // Minimum silence duration in ms

    public static void main(String[] args) {
        String filePath = "path_to_mp3_file.mp3";

        try (FileInputStream fis = new FileInputStream(filePath)) {
            Bitstream bitstream = new Bitstream(fis);
            Decoder decoder = new Decoder();
            Header header;
            int silenceCount = 0;
            boolean inSilence = false;
            int totalSilenceDuration = 0;

            while ((header = bitstream.readFrame()) != null) {
                SampleBuffer output = (SampleBuffer) decoder.decodeFrame(header, bitstream);

                short[] samples = output.getBuffer();
                int sampleRate = header.frequency();
                int frameSize = output.getBufferLength();
                double frameDuration = (double) frameSize / sampleRate;

                for (short sample : samples) {
                    if (Math.abs(sample) < SILENCE_THRESHOLD) {
                        silenceCount++;
                    } else {
                        if (silenceCount > sampleRate * (SILENCE_DURATION / 1000.0)) {
                            inSilence = true;
                            totalSilenceDuration += frameDuration * 1000;
                            System.out.println("Silence detected: " + totalSilenceDuration + " ms");
                        }
                        silenceCount = 0;
                        inSilence = false;
                    }
                }

                bitstream.closeFrame();
            }

            if (inSilence) {
                System.out.println("Total Silence Duration: " + totalSilenceDuration + " ms");
            } else {
                System.out.println("No significant silence detected.");
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
